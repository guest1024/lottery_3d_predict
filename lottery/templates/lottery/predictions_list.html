{% extends 'lottery/base.html' %}

{% block title %}é¢„æµ‹è®°å½• - 3Då½©ç¥¨é¢„æµ‹ç³»ç»Ÿ{% endblock %}

{% block content %}
<h1 style="margin-bottom: 20px; color: #303133;">ğŸ¯ é¢„æµ‹è®°å½•</h1>

<div class="card">
    <!-- ç­›é€‰æ  -->
    <div style="margin-bottom: 20px; display: flex; gap: 10px;">
        <a href="{% url 'lottery:predictions_list' %}" 
           class="btn {% if not should_bet %}btn-primary{% else %}{% endif %}"
           style="{% if should_bet %}background: #dcdfe6; color: #606266;{% endif %}">
            å…¨éƒ¨
        </a>
        <a href="{% url 'lottery:predictions_list' %}?should_bet=true" 
           class="btn {% if should_bet == 'true' %}btn-primary{% else %}{% endif %}"
           style="{% if should_bet != 'true' %}background: #dcdfe6; color: #606266;{% endif %}">
            âœ“ å»ºè®®æŠ•æ³¨
        </a>
        <a href="{% url 'lottery:predictions_list' %}?should_bet=false" 
           class="btn {% if should_bet == 'false' %}btn-primary{% else %}{% endif %}"
           style="{% if should_bet != 'false' %}background: #dcdfe6; color: #606266;{% endif %}">
            âœ— ä¸å»ºè®®æŠ•æ³¨
        </a>
    </div>
    
    <!-- é¢„æµ‹åˆ—è¡¨ -->
    {% if page_obj.object_list %}
    <table class="table">
        <thead>
            <tr>
                <th>é¢„æµ‹æœŸå·</th>
                <th>Top5æ•°å­—</th>
                <th>å¯ä¿¡åº¦</th>
                <th>æŠ•æ³¨å»ºè®®</th>
                <th>å»ºè®®é‡‘é¢</th>
                <th>é¢„æµ‹æ—¶é—´</th>
            </tr>
        </thead>
        <tbody>
            {% for pred in page_obj %}
            <tr>
                <td><strong>{{ pred.predicted_for_period }}</strong></td>
                <td>
                    {% for digit in pred.top5_digits %}
                        <span class="ball" style="width: 28px; height: 28px; font-size: 13px; margin-right: 5px;">{{ digit }}</span>
                    {% endfor %}
                </td>
                <td>
                    <span class="tag {% if pred.confidence_score >= 0.19 %}tag-success{% elif pred.confidence_score >= 0.188 %}tag-warning{% else %}tag-info{% endif %}">
                        {{ pred.confidence_score|floatformat:4 }}
                    </span>
                </td>
                <td>
                    {% if pred.should_bet %}
                        <span class="tag tag-success">âœ“ å»ºè®®æŠ•æ³¨</span>
                    {% else %}
                        <span class="tag tag-warning">âœ— ä¸å»ºè®®</span>
                    {% endif %}
                </td>
                <td>Â¥{{ pred.bet_amount }}</td>
                <td>{{ pred.created_at|date:"Y-m-d H:i" }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <!-- åˆ†é¡µ -->
    {% if page_obj.has_other_pages %}
    <div class="pagination">
        {% if page_obj.has_previous %}
            <a href="?page=1{% if should_bet %}&should_bet={{ should_bet }}{% endif %}" class="page-item">é¦–é¡µ</a>
            <a href="?page={{ page_obj.previous_page_number }}{% if should_bet %}&should_bet={{ should_bet }}{% endif %}" class="page-item">ä¸Šä¸€é¡µ</a>
        {% endif %}
        
        <span class="page-item active">{{ page_obj.number }}</span>
        
        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}{% if should_bet %}&should_bet={{ should_bet }}{% endif %}" class="page-item">ä¸‹ä¸€é¡µ</a>
            <a href="?page={{ page_obj.paginator.num_pages }}{% if should_bet %}&should_bet={{ should_bet }}{% endif %}" class="page-item">æœ«é¡µ</a>
        {% endif %}
        
        <span style="padding: 8px 12px; color: #909399;">
            å…± {{ page_obj.paginator.count }} æ¡
        </span>
    </div>
    {% endif %}
    
    {% else %}
    <div class="empty-state">
        <div class="empty-state-icon">ğŸ¯</div>
        <p>æš‚æ— é¢„æµ‹è®°å½•</p>
        <a href="{% url 'lottery:dashboard' %}" class="btn btn-primary" style="margin-top: 16px;">å‰å¾€ä»ªè¡¨æ¿ç”Ÿæˆé¢„æµ‹</a>
    </div>
    {% endif %}
</div>

{% endblock %}
